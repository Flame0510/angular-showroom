<app-page-header
  title="Reactive Forms"
  subtitle="Gestione avanzata dei form con validazione real-time"
></app-page-header>

<div class="form__container">
  <div class="form__card">
    <h2 class="form__title">Esempio Pratico</h2>
    <p class="form__subtitle">Compila tutti i campi per inviare il form</p>

    <form [formGroup]="reactiveForm" (ngSubmit)="onSubmit()">
      <!--/* NAME FIELD */-->
      <div class="form__group">
        <label class="form__label">
          Nome
          @if (reactiveForm.get('name')?.touched) {
            <span class="validation-icon">
              @if (reactiveForm.get('name')?.invalid) {
                <app-icon name="error" />
              } @else {
                <app-icon name="check" />
              }
            </span>
          }
        </label>
        <input
          type="text"
          class="form__input"
          formControlName="name"
          placeholder="Inserisci il tuo nome"
          [class.invalid]="reactiveForm.get('name')?.invalid && reactiveForm.get('name')?.touched"
          [class.valid]="reactiveForm.get('name')?.valid && reactiveForm.get('name')?.touched"
        />
        <div *ngIf="reactiveForm.get('name')?.errors && reactiveForm.get('name')?.touched" class="error__messages">
          <small *ngFor="let error of reactiveForm.get('name')?.errors | keyvalue" class="error__item">
            <span *ngIf="error.key === 'required'">Il nome è obbligatorio</span>
            <span *ngIf="error.key === 'minlength'">Minimo 3 caratteri</span>
            <span *ngIf="error.key === 'maxlength'">Massimo 20 caratteri</span>
            <span *ngIf="error.key === 'pattern'">Solo lettere alfabetiche</span>
          </small>
        </div>
      </div>

      <!--/* SURNAME FIELD */-->
      <div class="form__group">
        <label class="form__label">
          Cognome
          @if (reactiveForm.get('surname')?.touched) {
            <span class="validation-icon">
              @if (reactiveForm.get('surname')?.invalid) {
                <app-icon name="error" />
              } @else {
                <app-icon name="check" />
              }
            </span>
          }
        </label>
        <input
          type="text"
          class="form__input"
          formControlName="surname"
          placeholder="Inserisci il tuo cognome"
          [class.invalid]="reactiveForm.get('surname')?.invalid && reactiveForm.get('surname')?.touched"
          [class.valid]="reactiveForm.get('surname')?.valid && reactiveForm.get('surname')?.touched"
        />
        <div *ngIf="reactiveForm.get('surname')?.errors && reactiveForm.get('surname')?.touched" class="error__messages">
          <small class="error__item">Il cognome è obbligatorio</small>
        </div>
      </div>

      <!--/* EMAIL FIELD */-->
      <div class="form__group">
        <label class="form__label">
          Email
          @if (reactiveForm.get('email')?.touched) {
            <span class="validation-icon">
              @if (reactiveForm.get('email')?.invalid) {
                <app-icon name="error" />
              } @else {
                <app-icon name="check" />
              }
            </span>
          }
        </label>
        <input
          type="email"
          class="form__input"
          formControlName="email"
          placeholder="inserisci@email.com"
          [class.invalid]="reactiveForm.get('email')?.invalid && reactiveForm.get('email')?.touched"
          [class.valid]="reactiveForm.get('email')?.valid && reactiveForm.get('email')?.touched"
        />
        <div *ngIf="reactiveForm.get('email')?.errors && reactiveForm.get('email')?.touched" class="error__messages">
          <small *ngFor="let error of reactiveForm.get('email')?.errors | keyvalue" class="error__item">
            <span *ngIf="error.key === 'required'">L'email è obbligatoria</span>
            <span *ngIf="error.key === 'email' || error.key === 'pattern'">Formato email non valido</span>
          </small>
        </div>
      </div>

      <!--/* BUTTONS */-->
      <div class="form__actions">
        <button type="submit" class="btn btn__submit" [disabled]="reactiveForm.invalid">
          Invia Form
        </button>
        <button type="button" class="btn btn__reset" (click)="onReset()">
          Reset
        </button>
      </div>
    </form>
  </div>
</div>
